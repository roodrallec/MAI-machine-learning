import numpy as np
from fuzzy import fcm

# Resoruces
# https://es.mathworks.com/help/fuzzy/examples/fuzzy-c-means-clustering.html
# Prepare test data used by Matlab (fcmdata.dat)
x1 = [0.218959190000000, 0.679296410000000, 0.830965350000000,
      0.0534616350000000, 0.686772710000000, 0.0919648910000000,
      0.653918960000000, 0.701190590000000, 0.910320830000000,
      0.736081880000000, 0.632638570000000, 0.722660400000000,
      0.753355830000000, 0.0726858830000000, 0.272709970000000,
      0.766494780000000, 0.359264980000000, 0.904653090000000,
      0.493976680000000, 0.266144510000000, 0.0737490750000000,
      0.529747390000000, 0.464445820000000, 0.770204550000000,
      0.629543420000000, 0.736224510000000, 0.888572210000000,
      0.513273700000000, 0.591113580000000, 0.537303980000000,
      0.467917370000000, 0.287212370000000, 0.178327700000000,
      0.802405730000000, 0.498480120000000, 0.554583850000000,
      0.890737480000000, 0.624849290000000, 0.714709970000000,
      0.239910800000000, 0.681346210000000, 0.147533000000000,
      0.587186620000000, 0.590108610000000, 0.556146140000000,
      0.408766690000000, 0.564898680000000, 0.488514550000000,
      0.651253740000000, 0.247841760000000, 0.476431800000000,
      0.389314170000000, 0.203250330000000, 0.947486780000000,
      0.131188530000000, 0.885648370000000, 0.0921736300000000,
      0.365339030000000, 0.253057360000000, 0.783153170000000,
      0.349524140000000, 0.215248380000000, 0.679592370000000,
      0.250125590000000, 0.860859840000000, 0.817561480000000,
      0.755843530000000, 0.824697390000000, 0.103433930000000,
      0.576716640000000, 0.876565720000000, 0.440038660000000,
      0.869263740000000, 0.886031120000000, 0.463322730000000,
      0.713422320000000, 0.667679070000000, 0.682049120000000,
      0.315732410000000, 0.467531780000000, 0.319177590000000,
      0.682494230000000, 0.836419880000000, 0.708920610000000,
      0.828707950000000, 0.213546800000000, 0.389853590000000,
      0.776865820000000, 0.783865200000000, 0.282155890000000,
      0.819726090000000, 0.601010110000000, 0.828354720000000,
      0.157731180000000, 0.233599190000000, 0.634717440000000,
      0.794769810000000, 0.696242810000000, 0.752940410000000,
      0.669520640000000, 0.633429910000000, 0.227007720000000,
      0.699834440000000, 0.526123280000000, 0.329666390000000,
      0.485325180000000, 0.860225700000000, 0.556835780000000,
      0.738996610000000, 0.528548270000000, 0.310738870000000,
      0.588119120000000, 0.518083590000000, 0.370226280000000,
      0.475896220000000, 0.0782632080000000, 0.369742010000000,
      0.671784150000000, 0.676236920000000, 0.513936370000000,
      0.728608360000000, 0.720767820000000, 0.321560090000000,
      0.460434170000000, 0.661355500000000, 0.605639700000000,
      0.670098400000000, 0.522807710000000, 0.266613320000000,
      0.246733150000000, 0.817101330000000, 0.160748910000000,
      0.707826300000000, 0.436638450000000, 0.751710090000000,
      0.903301180000000, 0.584787200000000, 0.626861370000000,
      0.659053330000000, 0.538661290000000]
x2 = [0.719711080000000, 0.313898370000000, 0.479039930000000,
      0.779314850000000, 0.522195680000000, 0.714057610000000,
      0.166317870000000, 0.422224000000000, 0.318835530000000,
      0.457606850000000, 0.143807380000000, 0.320667800000000,
      0.463733230000000, 0.877493110000000, 0.648681260000000,
      0.392388530000000, 0.643075020000000, 0.186951990000000,
      0.548148770000000, 0.736379750000000, 0.790437690000000,
      0.400640690000000, 0.568091720000000, 0.163793440000000,
      0.230562620000000, 0.0659695270000000, 0.230885940000000,
      0.318334220000000, 0.243229820000000, 0.383389570000000,
      0.628534250000000, 0.775198800000000, 0.766308500000000,
      0.255895770000000, 0.338006490000000, 0.515819540000000,
      0.378954360000000, 0.0859750140000000, 0.503418000000000,
      0.670943900000000, 0.0602745970000000, 0.876151230000000,
      0.473662160000000, 0.482292780000000, 0.158423960000000,
      0.672772440000000, 0.423224140000000, 0.241754230000000,
      0.544927610000000, 0.916914290000000, 0.578421350000000,
      0.527620050000000, 0.710233540000000, 0.331179650000000,
      0.756249680000000, 0.288435550000000, 0.736337070000000,
      0.540237230000000, 0.767133020000000, 0.508656920000000,
      0.733880840000000, 0.865960860000000, 0.204144340000000,
      0.828844770000000, 0.393998700000000, 0.490341770000000,
      0.174163480000000, 0.368236730000000, 0.795437080000000,
      0.300309010000000, 0.293538730000000, 0.505369090000000,
      0.288428730000000, 0.138812560000000, 0.555480800000000,
      0.476228260000000, 0.246826230000000, 0.408411800000000,
      0.688394810000000, 0.531925270000000, 0.889980570000000,
      0.481226730000000, 0.143123880000000, 0.483091890000000,
      0.325475270000000, 0.654128260000000, 0.619885400000000,
      0.308873540000000, 0.237656110000000, 0.922675680000000,
      0.168744020000000, 0.276163540000000, 0.509182990000000,
      0.838580580000000, 0.726748890000000, 0.332950710000000,
      0.451263720000000, 0.389262330000000, 0.332034560000000,
      0.504874660000000, 0.428417390000000, 0.848783110000000,
      0.268636180000000, 0.477936540000000, 0.754857670000000,
      0.402831490000000, 0.388889440000000, 0.227969710000000,
      0.486851510000000, 0.303004250000000, 0.592462260000000,
      0.513150490000000, 0.520217140000000, 0.723353040000000,
      0.296630540000000, 0.764597280000000, 0.586505770000000,
      0.216997660000000, 0.0797476350000000, 0.318508880000000,
      0.178822670000000, 0.472587000000000, 0.748577880000000,
      0.348485460000000, 0.0640640590000000, 0.141234070000000,
      0.493180050000000, 0.297528620000000, 0.702935820000000,
      0.661490410000000, 0.514713960000000, 0.885525420000000,
      0.135390500000000, 0.508159260000000, 0.195087630000000,
      0.348705400000000, 0.0805080490000000, 0.477785350000000,
      0.138378220000000, 0.130505930000000]
testdata = np.array([x1, x2]).transpose()

testU = np.array(
    [[0.417022004702574, 0.30233257263183977, 0.1862602113776709,
      0.538816734003357, 0.20445224973151743, 0.6704675101784022,
      0.14038693859523377, 0.9682615757193975, 0.8763891522960383,
      0.03905478323288236, 0.0983468338330501, 0.5331652849730171,
      0.6865009276815837, 0.7501443149449675, 0.2804439920644052,
      0.44789352617590517, 0.28777533858634874, 0.678835532939891,
      0.4915731592803383, 0.14672857490581015, 0.10233442882782584,
      0.41417926952690265, 0.6637946452197888, 0.5865550405019929,
      0.13927634725075855, 0.16535419711693278, 0.7508121031361555,
      0.6236722070556089, 0.2699278917650261, 0.9648400471483856,
      0.11474597295337519, 0.5783896143871318, 0.9033795205622538,
      0.6171449136207239, 0.8859420993107745, 0.6233601157918027,
      0.690896917516924, 0.13713574962887776, 0.06600017272206249,
      0.9230245355464833, 0.01988013383979559, 0.2462110676030459,
      0.5528219786857659, 0.2791836790111395, 0.56103021925571,
      0.23297427384102043, 0.8635418545594287, 0.13645522566068502,
      0.044551878544761725, 0.7129889803826767, 0.07197427968948678,
      0.20329323466099047, 0.1954294811093188, 0.8468288014900353,
      0.6199557183813798, 0.018576202177409518, 0.6063294616533303,
      0.9886161544124489, 0.5509482191178968, 0.2649195576628094,
      0.6297175070215645, 0.06653648135411494, 0.19343428262332774,
      0.9248079703993507, 0.7350659632886695, 0.9319720691968373,
      0.6167783570016576, 0.5566531881951564, 0.39000771414124624,
      0.5495479215085626, 0.3948756129235549, 0.12632951943963733,
      0.021524805274197978, 0.015018980742122379, 0.1309968448109169,
      0.9401074823333672, 0.8447344453922219, 0.5463468160203733,
      0.4902535226199277, 0.5934814081966372, 0.31524480309537295,
      0.18401020162746506, 0.053909272073752956, 0.9186017779775258,
      0.37658031474577447, 0.828845807980693, 0.28557628169569393,
      0.8583138364290424, 0.8644794300545998, 0.45087393641334916,
      0.4014795834695406, 0.43024727082126435, 0.19856988842711087,
      0.7976388039585666, 0.6627198123752622, 0.8548979426974024,
      0.5724885171916063, 0.770883910501888, 0.3426889079532818,
      0.07962607769825236, 0.8118586977205398, 0.5694944127453757,
      0.345172051155215, 0.31226983770191696, 0.2571182937821962,
      0.49958417067888605, 0.24803355837723073, 0.6166850671552362,
      0.5158570169685298, 0.6218062317404155, 0.1445455401246598,
      0.519351824366033, 0.3243624597261865, 0.5384405925945437,
      0.8264069976293413, 0.651304332340991, 0.799615261736028,
      0.731728600739527, 0.6323033174301278, 0.44614623200345727,
      0.30024833953390007, 0.5415593788873733, 0.9939130246104789,
      0.1354279030721699, 0.1603951795196491, 0.36654309724374434,
      0.6909421420661686, 0.5815774073442912, 0.24773290176235485,
      0.4569753274356928, 0.21196016464367595, 0.02760601195450363,
      0.3810161240622142, 0.5409518049621886, 0.03232306662357398,
      0.9475489413950998, 0.081473964877262, 0.6337867606119179,
      0.7662113810757705, 0.42876877499944255],
     [0.7203244934421581, 0.14675589081711304, 0.34556072704304774,
      0.4191945144032948, 0.8781174363909454, 0.41730480236712697,
      0.1981014890848788, 0.31342417815924284, 0.8946066635038473,
      0.1698304195645689, 0.42110762500505217, 0.6918771139504734,
      0.8346256718973729, 0.9888610889064947, 0.7892793284514885,
      0.9085955030930956, 0.13002857211827767, 0.21162811600005904,
      0.053362545117080384, 0.5893055369032842, 0.4140559878195683,
      0.04995345894608716, 0.5148891120583086, 0.9034019152878835,
      0.8073912887095238, 0.9275085803960339, 0.7259979853504515,
      0.7509424340273372, 0.8958862181960668, 0.6634414978184481,
      0.9494892587070712, 0.40813680276128117, 0.5736794866722859,
      0.32664490177209615, 0.35726976000249977, 0.015821242846556283,
      0.9973228504514805, 0.9325954630371636, 0.7554630526024664,
      0.7115247586284718, 0.026210986877719278, 0.860027948682888,
      0.8420308923596057, 0.5857592714582879, 0.01864728937294302,
      0.8071051956187791, 0.7471216427371846, 0.05991768951221166,
      0.1074941291060929, 0.5597169820541424, 0.967276330000272,
      0.2523257445703234, 0.5813589272732578, 0.23984775914758616,
      0.8289808995501787, 0.07002214371922233, 0.5688514370864813,
      0.5797452192457969, 0.7453344309065021, 0.06633483442844157,
      0.2101740099148396, 0.26031509857854096, 0.6394608808799401,
      0.263296770487111, 0.7721780295432468, 0.013951572975597015,
      0.9490163206876164, 0.9156063497662745, 0.48599066709690975,
      0.9261814267064536, 0.9632625284407118, 0.13507915804673132,
      0.947970211217681, 0.17619625557505525, 0.8094906921265821,
      0.58201417994708, 0.9053923187086492, 0.7986035911520394,
      0.5991103076458784, 0.4336763489894583, 0.8928887085251513,
      0.7879292338255043, 0.4201936800011322, 0.00040202489135743313,
      0.9737835383583225, 0.5747115047081023, 0.586833340656083,
      0.7550821884676802, 0.32268099683674645, 0.3821027520315172,
      0.3173839459582769, 0.9738020779272523, 0.4267010093480328,
      0.8799982885634318, 0.2702082620297578, 0.5277146463087466,
      0.7331425252875111, 0.5688579907047155, 0.06820934841670412,
      0.982817113730445, 0.8749616449558981, 0.16097143681560877,
      0.2250399578140846, 0.9163055534683507, 0.1108913007440292,
      0.7285856679745962, 0.851671874936367, 0.23366613923925006,
      0.47714098704978236, 0.5440101188139381, 0.7515278171352439,
      0.7852960282216189, 0.872922376400111, 0.866608274166513,
      0.8541154438365387, 0.703516988152653, 0.03457121987163425,
      0.2596983932983531, 0.34529746159108154, 0.7827494147841719,
      0.14300582825809938, 0.9747403708550822, 0.5460708041429516,
      0.3557051709838811, 0.7456371927074961, 0.8623462528380441,
      0.18863680095531088, 0.9897517076637052, 0.26217308377291193,
      0.05692943841109499, 0.7986042447602102, 0.593432449464621,
      0.7498583107261434, 0.9594343210617524, 0.7093872512312951,
      0.2214327343234883, 0.42861882866378653, 0.8029632373737379,
      0.3424541198435198, 0.8240098704123188],
     [0.00011437481734488664, 0.0923385947687978, 0.39676747423066994,
      0.6852195003967595, 0.027387593197926163, 0.5586898284457517,
      0.8007445686755367, 0.6923226156693141, 0.08504421136977791,
      0.8781425034294131, 0.9578895301505019, 0.31551563100606295,
      0.018288277344191806, 0.7481656543798394, 0.10322600657764203,
      0.2936141483736795, 0.019366957870297075, 0.2655466593722262,
      0.5741176054920131, 0.6997583600209312, 0.6944001577277451,
      0.5358964059155116, 0.9445947559908133, 0.13747470414623753,
      0.3976768369855336, 0.34776585974550656, 0.8833060912058098,
      0.34889834197784253, 0.4280911898712949, 0.6216957202091218,
      0.4499121334799405, 0.2370269802430277, 0.00287032703115897,
      0.5270581022576093, 0.9085351509197992, 0.9294372337437613,
      0.17234050834532855, 0.6968181614899002, 0.7538761884612464,
      0.1242709619721647, 0.028306488020794607, 0.5388310643416528,
      0.12417331511991114, 0.9695957483196745, 0.8006326726806163,
      0.38786064406417176, 0.5562402339904189, 0.12134345574073735,
      0.2257093386078547, 0.012555980159115854, 0.5681004619199421,
      0.7438258540750929, 0.9700199890883123, 0.49376971426872995,
      0.15679139464608427, 0.4863451109370318, 0.31736240932216075,
      0.3801411726235504, 0.6692328934531846, 0.3700841979141063,
      0.7527555537388139, 0.8047545637433454, 0.5246703091237337,
      0.06596109068402378, 0.907815852503524, 0.2343620861214205,
      0.9501761192470797, 0.6415662089463375, 0.6043104829199732,
      0.9187334356336061, 0.17395566668046436, 0.5056621656768967,
      0.8271154711707325, 0.332063574366837, 0.34473665268329345,
      0.8788319844118441, 0.45988026581680697, 0.28571885173414757,
      0.015533275550835723, 0.8073605288848414, 0.5778572152845355,
      0.6120311770449339, 0.6790688365654296, 0.9767591490310596,
      0.604716100974053, 0.6280761983073504, 0.7500217637026599,
      0.698057248447303, 0.6707887907875872, 0.4108113499221856,
      0.6219193679203014, 0.6778008914343111, 0.343346239774423,
      0.903841955826372, 0.25236670150458973, 0.8021610840045981,
      0.5190116274640558, 0.4657098785919809, 0.37792417932809985,
      0.18161285133076377, 0.6884132523859433, 0.4668800227633063,
      0.5925118687657968, 0.9096355249515571, 0.19296273201911285,
      0.20819443840879148, 0.41584871826752734, 0.10196725942579743,
      0.15267164409316325, 0.6541373469707443, 0.2220491397999227,
      0.02233042799180618, 0.8447096076020696, 0.9498059913536265,
      0.09874340182034835, 0.6102408126466297, 0.7702387345549799,
      0.2570692988221467, 0.7965886780072875, 0.9904717836238407,
      0.9013084363492738, 0.6366044000018972, 0.5264259339055213,
      0.026218567296373285, 0.03039968992878883, 0.6926777175073543,
      0.44190428074842336, 0.20390622523312185, 0.7501724132979928,
      0.5085162406102396, 0.29733138150727223, 0.8438404289311888,
      0.5111414782971282, 0.8039608914986468, 0.46500148156350607,
      0.2670720196843658, 0.10901876401906829, 0.6968004961201785,
      0.8458514830276777, 0.6264961586242938]])

# Prepare reference result from Matlab
# data = load('fcmdata.dat'); rng(1); [center,U,obj_fcn] = fcm(data, 3);
ref_center = np.array(
    [[0.232126506294972, 0.721317160049014, 0.634555558002577],
    [0.752986074780793, 0.218336240083086, 0.454491765008853]]).transpose()

ref_U = np.array(
    [[0.99224971, 0.01815451, 0.05717605, 0.89568483, 0.02541894,
      0.91620372, 0.0126125, 0.01450404, 0.04542061, 0.02499367,
      0.02168419, 0.01710192, 0.03141856, 0.88449601, 0.90359253,
      0.02994427, 0.74386108, 0.03486739, 0.17978515, 0.99042005,
      0.91120421, 0.05164576, 0.27971505, 0.00794525, 0.01670754,
      0.02741073, 0.03110365, 0.07097834, 0.03176907, 0.04856978,
      0.3952342, 0.97765003, 0.98500733, 0.01232607, 0.08078262,
      0.05508605, 0.05110482, 0.0360449, 0.02624553, 0.95321824,
      0.03229006, 0.92327637, 0.01225352, 0.01305382, 0.04821674,
      0.66431055, 0.02383705, 0.08412419, 0.03466019, 0.89870715,
      0.26960048, 0.39690436, 0.98444461, 0.05589337, 0.95638216,
      0.03541575, 0.92329616, 0.48477429, 0.99616503, 0.05089609,
      0.88981871, 0.94596397, 0.0037465, 0.96962013, 0.04769291,
      0.05622875, 0.00496582, 0.03635697, 0.93301711, 0.04056815,
      0.03393848, 0.23622022, 0.03152552, 0.03333658, 0.25956326,
      0.01934674, 0.0075777, 0.01206755, 0.90880592, 0.21197068,
      0.8817449, 0.01033571, 0.02205475, 0.01902635, 0.02913595,
      0.93527631, 0.60776368, 0.01763749, 0.0070311, 0.87983843,
      0.01575729, 0.03083075, 0.06429767, 0.95001167, 0.99568749,
      0.02480219, 0.04218301, 0.01792496, 0.02055201, 0.01404137,
      0.00251743, 0.95880927, 0.00608928, 0.06366794, 0.93150826,
      0.09462527, 0.04664888, 0.04612099, 0.03035755, 0.06233181,
      0.73453296, 0.02802756, 0.10386563, 0.83817367, 0.09636255,
      0.9156342, 0.58381197, 0.00487691, 0.02762263, 0.07055591,
      0.00274229, 0.0213624, 0.94192954, 0.11454835, 0.03406955,
      0.03051139, 0.01017594, 0.06555272, 0.97360643, 0.93915764,
      0.06285311, 0.92159459, 0.01078476, 0.24773108, 0.00246841,
      0.04851973, 0.04909004, 0.00257197, 0.01636689, 0.05904008],
     [0.00252249, 0.65428832, 0.30997517, 0.03840028, 0.07065676,
      0.03020691, 0.9084507, 0.11382859, 0.64274713, 0.14840044,
      0.85891749, 0.69808768, 0.18228892, 0.04232469, 0.02928969,
      0.38485106, 0.06745139, 0.77872475, 0.12383488, 0.00298447,
      0.03232353, 0.15709649, 0.13094864, 0.94289786, 0.83980414,
      0.84918678, 0.7778298, 0.35696663, 0.70276045, 0.18261116,
      0.12085426, 0.00691818, 0.00508433, 0.88334027, 0.30702258,
      0.07589455, 0.53791634, 0.80504453, 0.09527017, 0.01482755,
      0.82804671, 0.02705274, 0.03006426, 0.03026144, 0.71611115,
      0.08218927, 0.07873731, 0.50262472, 0.06802009, 0.03422179,
      0.1281791, 0.1455462, 0.00513408, 0.60337599, 0.01529834,
      0.71333564, 0.02761492, 0.1326057, 0.00122163, 0.20987371,
      0.03115829, 0.01827191, 0.96721749, 0.00990992, 0.49671809,
      0.27808157, 0.96260201, 0.5473368, 0.02396922, 0.47523669,
      0.71440242, 0.15290411, 0.7313577, 0.80195874, 0.13316067,
      0.08958081, 0.91601433, 0.10288201, 0.0263172, 0.1358262,
      0.03790643, 0.04049536, 0.85988635, 0.08129976, 0.68204021,
      0.02113521, 0.09548476, 0.77220406, 0.93514851, 0.03996876,
      0.8909259, 0.62886429, 0.27776388, 0.01739658, 0.00138527,
      0.40685075, 0.28824498, 0.20883238, 0.66175554, 0.0418776,
      0.01293173, 0.01374901, 0.92276922, 0.09782363, 0.02009235,
      0.19690273, 0.50817357, 0.64742898, 0.13739979, 0.40827012,
      0.07605609, 0.0493433, 0.10662381, 0.04420033, 0.38870041,
      0.03062157, 0.10509971, 0.95456624, 0.84599336, 0.35674422,
      0.97863441, 0.10488711, 0.01712665, 0.29074836, 0.81936522,
      0.81109859, 0.03376056, 0.41896547, 0.00814521, 0.01912285,
      0.25848184, 0.02750232, 0.92807339, 0.15275405, 0.97982287,
      0.59438425, 0.75205518, 0.00781186, 0.89245835, 0.6919767],
     [0.0052278, 0.32755717, 0.63284878, 0.06591488, 0.9039243,
      0.05358938, 0.0789368, 0.87166737, 0.31183227, 0.82660589,
      0.11939831, 0.2848104, 0.78629252, 0.0731793, 0.06711778,
      0.58520466, 0.18868753, 0.18640786, 0.69637997, 0.00659549,
      0.05647226, 0.79125774, 0.58933632, 0.04915689, 0.14348831,
      0.12340249, 0.19106656, 0.57205503, 0.26547048, 0.76881906,
      0.48391155, 0.01543179, 0.00990834, 0.10433366, 0.61219479,
      0.8690194, 0.41097884, 0.15891057, 0.8784843, 0.03195421,
      0.13966323, 0.04967089, 0.95768222, 0.95668474, 0.23567211,
      0.25350019, 0.89742564, 0.41325108, 0.89731972, 0.06707106,
      0.60222042, 0.45754944, 0.01042131, 0.34073063, 0.0283195,
      0.2512486, 0.04908892, 0.38262001, 0.00261335, 0.73923021,
      0.079023, 0.03576411, 0.02903601, 0.02046996, 0.455589,
      0.66568968, 0.03243217, 0.41630623, 0.04301367, 0.48419516,
      0.2516591, 0.61087567, 0.23711678, 0.16470468, 0.60727607,
      0.89107245, 0.07640797, 0.88505043, 0.06487687, 0.65220312,
      0.08034867, 0.94916893, 0.1180589, 0.89967389, 0.28882384,
      0.04358848, 0.29675155, 0.21015844, 0.05782038, 0.08019281,
      0.09331681, 0.34030497, 0.65793844, 0.03259175, 0.00292725,
      0.56834706, 0.66957201, 0.77324267, 0.31769245, 0.94408103,
      0.98455084, 0.02744172, 0.07114149, 0.83850843, 0.04839939,
      0.70847201, 0.44517755, 0.30645003, 0.83224266, 0.52939807,
      0.18941095, 0.92262914, 0.78951057, 0.117626, 0.51493705,
      0.05374423, 0.31108832, 0.04055685, 0.12638401, 0.57269987,
      0.0186233, 0.87375049, 0.04094381, 0.59470329, 0.14656522,
      0.15839002, 0.95606351, 0.51548181, 0.01824836, 0.04171951,
      0.67866505, 0.05090309, 0.06114186, 0.59951487, 0.01770872,
      0.35709602, 0.19885478, 0.98961617, 0.09117477, 0.24898323]])

ref_obj_fcn = np.array(
    [6.24207272733192, 4.80852726912186, 4.25433707302548, 3.05336267524084,
     2.40919544233153, 2.23982088301529, 2.12803790132263, 2.07787953919480,
     2.06690105494596, 2.06497459587931, 2.06456557359895, 2.06443740246149,
     2.06437621168744, 2.06433777339607, 2.06431061071545, 2.06429061792606,
     2.06427570749637, 2.06426453975870, 2.06425616279367],
    ndmin=2).transpose()

# Run Fuzzy C-Means
center, U, obj_fcn = fcm(testdata, 3, initU=testU)

# Compare obtained results with reference results
eps = 1e-6
assert np.abs(center-ref_center).max() < eps
assert np.abs(U-ref_U).max() < eps
assert np.abs(obj_fcn-ref_obj_fcn).max() < eps
